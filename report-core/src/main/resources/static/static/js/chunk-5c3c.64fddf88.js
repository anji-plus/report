(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-5c3c"],{"+THm":function(e,t,r){"use strict";var a=r("Li4V");r.n(a).a},"/rDb":function(e,t,r){},"0t1K":function(e,t,r){"use strict";r.r(t);var a=r("14Xm"),o=r.n(a),n=r("D3Ub"),i=r.n(n),s=r("W6l8"),l=r("sm2R"),c={components:{Dictionary:r("CJ5O").a},props:{visib:{required:!0,type:Boolean,default:!1},reportCode:{required:!0,type:String,default:function(){return""}},reportName:{required:!0,type:String,default:function(){return""}},reportType:{required:!0,type:String,default:function(){return""}}},data:function(){return{title:"报表分享",reportShareUrl:"",shareValidTypeOptions:[],dialogForm:{shareValidType:0,reportCode:"",reportType:"",shareUrl:"",shareCode:"",sharePassword:"",sharePasswordFlag:!1},shareLinkFlag1:!0,rules:{shareValidType:[{required:!0,message:"有效期必选",trigger:"change"}]}}},watch:{visib:function(e){e&&this.getSystem()}},created:function(){},methods:{titleBuild:function(){return"【"+this.reportName+"】报表分享"},selectChange:function(e){this.dialogForm.shareValidType=e},getSystem:function(){var e=this;return i()(o.a.mark(function t(){var r,a,n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.shareLinkFlag1=!0,t.next=3,Object(l.a)("SHARE_VAILD");case 3:if(r=t.sent,a=r.code,n=r.data,"200"==a){t.next=8;break}return t.abrupt("return");case 8:e.shareValidTypeOptions=n,e.dialogForm.shareValidType=e.shareValidTypeOptions[0].id,e.dialogForm.sharePasswordFlag=!1,e.dialogForm.sharePassword="";case 12:case"end":return t.stop()}},t,e)}))()},createShare:function(){var e=this;return i()(o.a.mark(function t(){var r,a,n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.dialogForm.reportType=e.reportType,e.dialogForm.reportCode=e.reportCode,e.dialogForm.shareUrl=window.location.href,t.next=5,Object(s.a)(e.dialogForm);case 5:if(r=t.sent,a=r.code,n=r.data,"200"==a){t.next=10;break}return t.abrupt("return");case 10:e.shareLinkFlag1=!1,e.$message({message:"创建链接成功！",type:"success"}),e.reportShareUrl=n.shareUrl,e.dialogForm.sharePassword=n.sharePassword;case 14:case"end":return t.stop()}},t,e)}))()},copyShare:function(){var e="";e=""==this.dialogForm.sharePassword?"AJ-Report分享链接："+this.reportShareUrl:"AJ-Report分享链接："+this.reportShareUrl+"  分享码："+this.dialogForm.sharePassword,this.copyToClip(e),this.$message({message:"复制链接成功！",type:"success"})},copyToClip:function(e,t){var r=document.createElement("input");r.setAttribute("value",e),document.body.appendChild(r),r.select(),document.execCommand("copy"),document.body.removeChild(r)},saveReportShare:function(){var e=this;return i()(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:({}),e.closeDialog();case 2:case"end":return t.stop()}},t,e)}))()},closeDialog:function(){this.$emit("handleClose")}}},u=r("KHd+"),d=Object(u.a)(c,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{staticClass:"tree_dialog",attrs:{title:e.titleBuild(),width:"30%","close-on-click-modal":!1,center:"",visible:e.visib,"before-close":e.closeDialog},on:{"update:visible":function(t){e.visib=t}}},[e.shareLinkFlag1?r("div",[r("el-form",{ref:"userForm",attrs:{model:e.dialogForm,rules:e.rules,size:"small","label-width":"100px"}},[r("el-form-item",{attrs:{label:"有效期",prop:"shareValidType"}},[r("el-select",{attrs:{placeholder:"请选择",clearable:""},on:{change:e.selectChange},model:{value:e.dialogForm.shareValidType,callback:function(t){e.$set(e.dialogForm,"shareValidType","string"==typeof t?t.trim():t)},expression:"dialogForm.shareValidType"}},e._l(e.shareValidTypeOptions,function(e){return r("el-option",{key:e.id,attrs:{label:e.text,value:e.id}})}),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"分享码",prop:"sharePasswordFlag"}},[r("el-switch",{model:{value:e.dialogForm.sharePasswordFlag,callback:function(t){e.$set(e.dialogForm,"sharePasswordFlag",t)},expression:"dialogForm.sharePasswordFlag"}})],1)],1),e._v(" "),r("el-button",{staticStyle:{"margin-left":"45px"},attrs:{type:"primary",plain:""},on:{click:e.createShare}},[e._v("创建链接")])],1):r("div",[r("el-form",{ref:"userForm",attrs:{model:e.dialogForm,rules:e.rules,size:"small","label-width":"100px"}},[r("el-form-item",{attrs:{label:"链接",prop:"reportShareUrl"}},[r("el-input",{attrs:{disabled:!0},model:{value:e.reportShareUrl,callback:function(t){e.reportShareUrl=t},expression:"reportShareUrl"}})],1),e._v(" "),e.dialogForm.sharePasswordFlag?r("el-form-item",{attrs:{label:"分享码",prop:"sharePassword"}},[r("el-input",{attrs:{disabled:!0},model:{value:e.dialogForm.sharePassword,callback:function(t){e.$set(e.dialogForm,"sharePassword",t)},expression:"dialogForm.sharePassword"}})],1):e._e(),e._v(" "),r("el-row",{attrs:{gutter:10}},[""==e.dialogForm.sharePassword?r("el-button",{staticStyle:{"margin-left":"45px"},attrs:{type:"primary",plain:""},on:{click:e.copyShare}},[e._v("复制链接")]):e._e(),e._v(" "),""!=e.dialogForm.sharePassword?r("el-button",{staticStyle:{"margin-left":"45px"},attrs:{type:"primary",plain:""},on:{click:e.copyShare}},[e._v("复制链接和分享码")]):e._e()],1)],1)],1),e._v(" "),r("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"danger",plain:""},on:{click:e.closeDialog}},[e._v("取消")])],1)])},[],!1,null,null,null);d.options.__file="shareConfig.vue";var p=d.exports,m=r("HDHf"),h={name:"Login",components:{ShareConfig:p},data:function(){return{list:[],rules:{},totalCount:0,totalPage:0,params:{reportCode:"",reportName:"",reportType:"report_excel",pageNumber:1,pageSize:8,order:"DESC",sort:"update_time"},visibleForShareDialog:!1,reportCodeForShareDialog:"",reportNameForShareDialog:"",reportTypeForShareDialog:""}},mounted:function(){},created:function(){this.queryByPage()},methods:{search:function(){this.params.pageNumber=1,this.queryByPage()},reset:function(e){this.$refs[e].resetFields(),this.params.reportName="",this.params.reportCode="",this.params.pageNumber=1,this.queryByPage()},queryByPage:function(){var e=this;return i()(o.a.mark(function t(){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(m.g)(e.params);case 2:if("200"==(r=t.sent).code){t.next=5;break}return t.abrupt("return");case 5:e.listLoading=!0,e.list=r.data.records,e.list.forEach(function(e){e.reportNameCode=e.reportName+"["+e.reportCode+"]"}),e.totalCount=r.data.total,e.totalPage=r.data.pages,e.listLoading=!1;case 11:case"end":return t.stop()}},t,e)}))()},handleSizeChange:function(e){this.params.pageSize=e,this.queryByPage()},handleCurrentChange:function(e){this.params.pageNumber=e,this.queryByPage()},share:function(e){this.reportCodeForShareDialog=e.reportCode,this.reportNameForShareDialog=e.reportName,this.reportTypeForShareDialog=e.reportType,this.visibleForShareDialog=!0},openDesign:function(e){var t=this.$router.resolve({path:"/excelreport/designer",query:{reportCode:e.reportCode}});window.open(t.href,"_blank")},viewDesign:function(e){var t=this.$router.resolve({path:"/excelreport/viewer",query:{reportCode:e.reportCode}});window.open(t.href,"_blank")}}},f=(r("+THm"),Object(u.a)(h,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main-layout"},[a("el-form",{ref:"form",attrs:{model:e.params,rules:e.rules,"label-width":"120px"}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{xs:24,sm:20,md:12,lg:6,xl:4}},[a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{staticClass:"filter-item",attrs:{size:"mini",clearable:"",placeholder:"名称"},model:{value:e.params.reportName,callback:function(t){e.$set(e.params,"reportName",t)},expression:"params.reportName"}})],1)],1),e._v(" "),a("el-col",{attrs:{xs:24,sm:20,md:12,lg:6,xl:4}},[a("el-form-item",{attrs:{label:"报表编码"}},[a("el-input",{staticClass:"filter-item",attrs:{size:"mini",clearable:"",placeholder:"报表编码"},model:{value:e.params.reportCode,callback:function(t){e.$set(e.params,"reportCode",t)},expression:"params.reportCode"}})],1)],1),e._v(" "),a("el-col",{attrs:{xs:24,sm:20,md:4,lg:4,xl:4}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.search("form")}}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.reset("form")}}},[e._v("重置")])],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},e._l(e.list,function(t){return a("el-col",{key:t.id,attrs:{span:6}},[a("div",{staticClass:"bg"},[a("img",{staticClass:"bg-img",attrs:{src:null==t.reportImage||""==t.reportImage?r("fy9d"):t.reportImage,alt:""}}),e._v(" "),a("div",{staticClass:"content"},[a("header",[e._v(e._s(t.reportName))]),e._v(" "),a("footer",[e._v("\n            "+e._s(t.updateTime)+"\n            "),a("div",{staticClass:"operation"},[a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"excelManage:share",expression:"'excelManage:share'"}],staticClass:"view",attrs:{icon:"el-icon-share",type:"text"},on:{click:function(r){return e.share(t)}}}),e._v(" "),a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"excelManage:view",expression:"'excelManage:view'"}],staticClass:"view",attrs:{icon:"el-icon-view",type:"text"},on:{click:function(r){return e.viewDesign(t)}}}),e._v(" "),a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"excelManage:update",expression:"'excelManage:update'"}],staticClass:"edit",attrs:{icon:"el-icon-edit",type:"text"},on:{click:function(r){return e.openDesign(t)}}})],1)])])])])}),1),e._v(" "),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{total:e.totalCount,"page-sizes":[8,20,50,100],"page-size":e.params.pageSize,"current-page":e.params.pageNumber,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("ShareConfig",{attrs:{visib:e.visibleForShareDialog,reportCode:e.reportCodeForShareDialog,reportName:e.reportNameForShareDialog,reportType:e.reportTypeForShareDialog},on:{handleClose:function(t){e.visibleForShareDialog=!1}}})],1)},[],!1,null,"182aa6cc",null));f.options.__file="index.vue";t.default=f.exports},"1C1b":function(e,t,r){"use strict";var a=r("/rDb");r.n(a).a},CJ5O:function(e,t,r){"use strict";var a=r("14Xm"),o=r.n(a),n=r("D3Ub"),i=r.n(n),s=r("sm2R"),l={name:"GetDictionary",props:{dictKey:String,updataDict:String,value:String},data:function(){return{dictionary:"",dictionaryOptions:[]}},watch:{dictKey:{immediate:!0,handler:function(){this.getSystem()}},value:{handler:function(e){this.dictionary=e},deep:!0}},created:function(){this.getSystem()},mounted:function(){this.dictionary=this.value},methods:{getSystem:function(){var e=this;return i()(o.a.mark(function t(){var r,a,n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(s.a)(e.dictKey);case 2:if(r=t.sent,a=r.code,n=r.data,"200"==a){t.next=7;break}return t.abrupt("return");case 7:e.dictionaryOptions=n;case 8:case"end":return t.stop()}},t,e)}))()},selectChange:function(e){this.$emit("input",e),this.$emit("change",e)}}},c=(r("1C1b"),r("KHd+")),u=Object(c.a)(l,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-select",{attrs:{placeholder:"请选择",clearable:"",size:"mini"},on:{change:e.selectChange},model:{value:e.dictionary,callback:function(t){e.dictionary=t},expression:"dictionary"}},e._l(e.dictionaryOptions,function(e){return r("el-option",{key:e.id,attrs:{label:e.text,value:e.id}})}),1)},[],!1,null,"9e2cd716",null);u.options.__file="index.vue";t.a=u.exports},HDHf:function(e,t,r){"use strict";r.d(t,"c",function(){return o}),r.d(t,"a",function(){return n}),r.d(t,"d",function(){return i}),r.d(t,"f",function(){return s}),r.d(t,"i",function(){return l}),r.d(t,"h",function(){return c}),r.d(t,"g",function(){return u}),r.d(t,"b",function(){return d}),r.d(t,"e",function(){return p});var a=r("t3Un");function o(e){return Object(a.a)({url:"/dataSet/detailBysetId/"+e.id,method:"get"})}function n(e){return Object(a.a)({url:"/dataSet",method:"post",data:e})}function i(e){return Object(a.a)({url:"/dataSet",method:"put",data:e})}function s(e){return Object(a.a)({url:"/dataSource/queryAllDataSource",method:"get",data:e})}function l(e){return Object(a.a)({url:"/dataSetParam/verification",method:"post",data:e})}function c(e){return Object(a.a)({url:"/dataSet/testTransform",method:"post",data:e})}function u(e){return Object(a.a)({url:"/report/pageList",method:"get",params:e})}function d(e){return Object(a.a)({url:"/reportExcel",method:"post",data:e})}function p(e){return Object(a.a)({url:"/reportExcel",method:"put",data:e})}},Li4V:function(e,t,r){},W6l8:function(e,t,r){"use strict";r.d(t,"g",function(){return o}),r.d(t,"b",function(){return n}),r.d(t,"a",function(){return i}),r.d(t,"c",function(){return s}),r.d(t,"d",function(){return l}),r.d(t,"e",function(){return c}),r.d(t,"f",function(){return u});var a=r("t3Un");function o(e){return Object(a.a)({url:"reportShare/pageList",method:"GET",params:e})}function n(e){return Object(a.a)({url:"reportDashboard/share",method:"post",data:e})}function i(e){return Object(a.a)({url:"reportExcel/share",method:"post",data:e})}function s(e){return Object(a.a)({url:"reportShare/shareDelay",method:"post",data:e})}function l(e){return Object(a.a)({url:"reportShare/delete/batch",method:"post",data:e})}function c(e){return Object(a.a)({url:"reportShare/"+e.id,method:"get",params:{accessKey:e.accessKey}})}function u(e){return Object(a.a)({url:"reportShare/detailByCode",method:"get",params:{shareCode:e}})}},fy9d:function(e,t,r){e.exports=r.p+"static/img/charts.47700dc.jpg"}}]);